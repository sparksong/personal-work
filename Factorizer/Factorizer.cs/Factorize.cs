using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace Factorizer.cs
{
    class Factorize
    {
        public static void Start()
        {
            Console.Title = "FACTORIZER FACTORIZER FACTORIZER!";
            bool choice = true;
            while (choice)
            {
                ShowMenu();
                choice = MenuChoice();
            }
        }

        public static void ShowMenu()
        {
            ConsoleIO.WindowSetup();
            Console.WriteLine(ConsoleIO.Separator);
            Console.WriteLine(ConsoleIO.Blanks);
            Console.WriteLine("@                   Factorize me, Cap'n!                   @");
            Console.WriteLine(ConsoleIO.Blanks);
            Console.WriteLine("@                 DO YOU WANT TO FACTORIZE?                @");
            Console.WriteLine("@                      Enter a choice!                     @");
            Console.WriteLine(ConsoleIO.Blanks);
            Console.WriteLine("@ 1) Yes                                                   @");
            Console.WriteLine("@ 2) No                                                    @");
            Console.WriteLine("@ 3) ????                                                  @");
            Console.WriteLine("@ 4) Profit!                                               @");
            Console.WriteLine(ConsoleIO.Blanks);
            Console.WriteLine(ConsoleIO.Separator);

            Console.Write("Enter a choice: ");
        }

        private static bool MenuChoice()
        {
            string userInput = Console.ReadLine();
            ConsoleIO.WindowSetup();

            switch (userInput.ToUpper())
            {
                case "1":
                    Factorizing();
                    return false;
                case "2":
                    ConsoleIO.Goodbye();
                    return false;
                case "3":
                    Console.Clear();
                    Console.WriteLine("???????????????????????????????????????????????????????????\n????????????????????????????????????????????????????????????\n????????????????????????????????????????????????????????????\n????????????????????????????????????????????????????????????\n????????????????????????????????????????????????????????????\n????????????????????????????????????????????????????????????\n????????????????????????????????????????????????????????????\n????????????????????????????????????????????????????????????\n????????????????????????????????????????????????????????????\n????????????????????????????????????????????????????????????\n????????????????????????????????????????????????????????????\n????????????????????????????????????????????????????????????\n????????????????????????????????????????????????????????????\n????????????????????????????????????????????????????????????\n????????????????????????????????????????????????????????????\n????????????????????????????????????????????????????????????\n????????????????????????????????????????????????????????????\n????????????????????????????????????????????????????????????\n????????????????????????????????????????????????????????????\n????????????????????????????????????????????????????????????\n");
                    Console.ReadKey();
                    Console.Clear();
                    break;
                case "4":
                    Console.WriteLine("$Dolla Dolla Bills Y'all.$ ");
                    Console.ReadKey();
                    Console.Clear();
                    break;
                default:
                    Console.ForegroundColor = ConsoleColor.Red;
                    Console.WriteLine("Please enter a valid choice. Press any key to continue. ");
                    Console.ResetColor();
                    Console.ReadLine();
                    Console.Clear();
                    break;
            }

            return true;
        }

        public static void Factorizing()
        {
            int numbersFactorized = 0;
            bool play = true;

            // Start Logic
            int factorNumber = 0;
            while (play)
            {
                do
                {
                    Console.Clear();
                    FactorizingMenu();

                    int.TryParse(Console.ReadLine(), out factorNumber);
                    double perfect = 1;
                    List<int> list = new List<int>();

                    if (factorNumber > 0)
                    {
                        for (int i = 1; i <= factorNumber / 2; i++)
                        {
                            if (factorNumber % i == 0)
                            {
                                list.Add(i);
                                perfect += i;
                            }
                        }
                        list.Add(factorNumber);
                        if (factorNumber == perfect - 1 || factorNumber == 1)
                        {
                            Console.WriteLine("PERFECTION!");
                            Console.WriteLine("There are " + list.Count + " factors of " + factorNumber + "! \nThe factors are: ");
                            list.ForEach(Console.Write);
                            Console.ReadKey();
                            break;
                        }
                        else
                        {
                            if (list.Count != 2)
                            {
                                Console.WriteLine("Your number is: {0}", factorNumber);
                                Console.WriteLine("There are " + list.Count + " factors of " + factorNumber + "! \nThe factors are: ");
                                list.ForEach(Console.Write);
                                Console.ReadKey();
                                break;
                            }
                            else
                            {
                                Console.WriteLine("Your number is: {0}", factorNumber);
                                Console.WriteLine("The only factors are ");
                                list.ForEach(Console.Write);
                                Console.ReadKey();
                                break;
                            }
                        }
                    }
                    else
                    {
                        Console.ForegroundColor = ConsoleColor.Red;
                        Console.WriteLine("Input is not valid!");
                        Console.ResetColor();
                        Console.WriteLine("Press any key to try again.");
                        Console.ReadKey();
                    }
                }
                while (true);
                //Logic end
                numbersFactorized++;
                Console.Title = String.Format("Numbers factored: {0}", numbersFactorized);

                string userInput = ConsoleIO.GetYesNoAnswerFromUser("\nWould you like to factor another?");
                if ((userInput.ToUpper() == "Y") || (userInput.ToUpper() == "YES"))
                {
                    play = true;
                }
                else if ((userInput.ToUpper() == "N") || (userInput.ToUpper() == "NO"))
                {
                    play = false;
                    ConsoleIO.Goodbye();
                    break;
                }
                else
                {
                    Console.ForegroundColor = ConsoleColor.Red;
                    Console.WriteLine("Please enter Y/N only! ");
                    Console.ResetColor();
                    Console.WriteLine("Press any key to continue. ");
                    Console.ReadKey();
                }
            }
            return;
        }

        public static void FactorizingMenu()
        {
            ConsoleIO.WindowSetup();
            Console.WriteLine(ConsoleIO.Separator);
            Console.WriteLine(ConsoleIO.Blanks);
            Console.WriteLine("@                   Factorize me, Cap'n!                   @");
            Console.WriteLine(ConsoleIO.Blanks);
            Console.WriteLine("@          What number do you want to factorize?!          @");
            Console.WriteLine(ConsoleIO.Blanks);
            Console.WriteLine("@  Enter a positive number.                ##  ##          @");
            Console.WriteLine("@  And I will tell you the factors!      ##########        @");
            Console.WriteLine("@  Prime?                                  ##  ##          @");
            Console.WriteLine("@  Perfect?                              ##########        @");
            Console.WriteLine("@  Let's find out!                         ##  ##          @");
            Console.WriteLine(ConsoleIO.Blanks);
            Console.WriteLine(ConsoleIO.Separator);
            Console.WriteLine("Which number would you like to try? ");
        }
    }
}